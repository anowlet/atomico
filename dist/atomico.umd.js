!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.atomico={})}(this,function(e){"use strict";function t(e,t){e.removeChild(t)}function n(e,t){e.appendChild(t)}function r(e,t,...n){return new s(e,t,function e(t,n=[]){for(let r=0;r<t.length;r++){let s=t[r];Array.isArray(s)?e(s,n):n.push(s)}return n}(n))}class s{constructor(e,t,n){this.tag=e,this.props=t||{},this.children=n||[]}clone(e=this.tag,t=this.props,n=this.children){return new s(e,Object.assign({},t),n)}}let i="__PREVIOUS__",o="__LISTENERS__";function l(e){let l=e.tagName.toLowerCase();return e[i]=r(l),c=>{c=function(e){return e instanceof s}(c)&&"host"===c.tag?c.clone(l):r(l,{},c),function e(r,l,c,h,p,a){let d=c&&c[i]||new s,u=c;h&&"function"==typeof h.tag&&(h=h.tag(Object.assign({},h.props,{children:h.children})));h instanceof s||(h=new s("",{},h));if(d.tag!==h.tag)if(u=function(e,t){return t?document.createElementNS("http://www.w3.org/2000/svg",e):e?document.createElement(e):document.createTextNode("")}(h.tag,p),c){if(""!==h.tag){let e=h.children.length;for(;c.firstChild&&e--;)n(u,c.firstChild)}!function(e,t,n){e.replaceChild(t,n)}(l,u,c)}else n(l,u);if(h.tag)if(function(e,t,n,r){let s=Object.keys(t),i=Object.keys(n),l=s.concat(i),c={};for(let s=0;s<l.length;s++){let i=l[s];if(c[i]||t[i]===n[i])continue;c[i]=!0;let h="function"==typeof t[i],p="function"==typeof n[i];if(h||p)!p&&h&&e.removeEventListener(i,e[o][i][0]),p&&(h||(e[o]=e[o]||{},e[o][i]||(e[o][i]=[t=>{e[o][i][1](t)}]),e.addEventListener(i,e[o][i][0])),e[o][i][1]=n[i]);else if(i in n)if(i in e&&!r||r&&"style"===i)if("style"===i)if("object"==typeof n[i]){let r=t[i]||{},s=n[i];for(let t in s)r[t]!==s[t]&&("-"===t[0]?e.style.setProperty(t,s[t]):e.style[t]=s[t])}else e.style.cssText=n[i];else e[i]=n[i];else r?e.setAttributeNS(null,i,n[i]):e.setAttribute(i,n[i]);else e.removeAttribute(i)}}(u,d.tag===h.tag?d.props:{},h.props,p),"slot"===h.tag){h.props.name}else{let n=a?u:u.shadowRoot||u,s=n.childNodes,i=h.children,o=0,l=Math.max(i.length,s.length);for(let c=0;c<l;c++){let l=c-o;c in i?e(r,n,s[l],i[c],p,a+1):(t(n,s[l]),o++)}}else d.children!==h.children&&(u.textContent=h.children);u[i]=h;return u}(e,e,e,c)}}function c(e){return e.replace(/-+([\w])/g,(e,t)=>t.toUpperCase())}function h(e){let t=Array.isArray(e),n=[],r={};for(let s in e){let i=(t?e[s]:s).replace(/([^\-])([A-Z]+)/,(e,t,n)=>t+"-"+n.toLowerCase());t?n.push(i):(n.push(i),r[i]=e[s],r[c(s)]=e[s])}return{keys:n,types:r}}e.Element=class extends HTMLElement{constructor(){super();let e,t=l(this);this.props={},this.countRender=0,this.preventRender=!0,this.proxy=h(this.constructor.props),this.load=(()=>{this.preventRender=!1,e()}),this.await=new Promise(t=>e=t),this.rerender=(e=>{this.preventRender||(this.preventRender=!0,Promise.resolve().then(()=>{t(this.render()),this.preventRender=!1,this.countRender++?this.onUpdated():this.onMounted()}))}),this.proxy.keys.forEach(e=>{e=c(e),Object.defineProperty(this,e,{set(t){this.setProps({[e]:t})},get(){return this.props[e]}})})}static get props(){return[]}render(){}onMounted(){}onUpdated(){}onUnmounted(){}setProps(e){let t,n={};for(let r in e){let s=this.props[r];if(e[r]!==s){let i=this.proxy.types[r],o=i?i(e[r],s):e[r];o!==s&&(n[r]=o,t=!0)}}t&&(this.props=Object.assign({},this.props,n),this.rerender())}setAttribute(e,t){this.proxy.keys.indexOf(e)>-1?this.setProps({[c(e)]:t}):super.setAttribute(e,t)}static get observedAttributes(){return h(this.props).keys}connectedCallback(){this.load(),this.await.then(()=>this.rerender())}disconnectedCallback(){this.await.then(()=>this.onUnmounted())}attributeChangedCallback(e,t,n){this.setProps({[e]:n})}},e.h=r,e.createRender=l,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=atomico.umd.js.map
