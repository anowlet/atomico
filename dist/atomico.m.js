function remove(e,t){e.removeChild(t)}function append(e,t){e.appendChild(t)}function replace(e,t,n){e.replaceChild(t,n)}function create(e,t){return t?document.createElementNS("http://www.w3.org/2000/svg",e):e?document.createElement(e):document.createTextNode("")}function h(e,t,...n){return new VDom(e,t,concat(n))}class VDom{constructor(e,t,n){this.tag=e,this.props=t||{},this.children=n||[]}clone(e=this.tag,t=this.props,n=this.children){return new VDom(e,Object.assign({},t),n)}}function isVDom(e){return e instanceof VDom}function concat(e,t=[]){for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?concat(r,t):t.push(r)}return t}let PREVIOUS="__PREVIOUS__",LISTENERS="__LISTENERS__";function createRender(e){let t=e.tagName.toLowerCase();return e[PREVIOUS]=h(t),n=>{n=isVDom(n)&&"host"===n.tag?n.clone(t):h(t,{},n),diff(e,e,e,n)}}function diff(e,t,n,r,s,o){let i=n&&n[PREVIOUS]||new VDom,c=n;if(r&&"function"==typeof r.tag&&(r=r.tag(Object.assign({},r.props,{children:r.children}))),r instanceof VDom||(r=new VDom("",{},r)),i.tag!==r.tag)if(c=create(r.tag,s),n){if(""!==r.tag){let e=r.children.length;for(;n.firstChild&&e--;)append(c,n.firstChild)}replace(t,c,n)}else append(t,c);if(r.tag)if(diffProps(c,i.tag===r.tag?i.props:{},r.props,s),"slot"===r.tag){r.props.name}else{let t=o?c:c.shadowRoot||c,n=t.childNodes,i=r.children,l=0,a=Math.max(i.length,n.length);for(let r=0;r<a;r++){let c=r-l;r in i?diff(e,t,n[c],i[r],s,o+1):(remove(t,n[c]),l++)}}else i.children!==r.children&&(c.textContent=r.children);return c[PREVIOUS]=r,c}function diffProps(e,t,n,r){let s=Object.keys(t),o=Object.keys(n),i=s.concat(o),c={};for(let s=0;s<i.length;s++){let o=i[s];if(c[o]||t[o]===n[o])continue;c[o]=!0;let l="function"==typeof t[o],a="function"==typeof n[o];if(l||a)!a&&l&&e.removeEventListener(o,e[LISTENERS][o][0]),a&&(l||(e[LISTENERS]=e[LISTENERS]||{},e[LISTENERS][o]||(e[LISTENERS][o]=[t=>{e[LISTENERS][o][1](t)}]),e.addEventListener(o,e[LISTENERS][o][0])),e[LISTENERS][o][1]=n[o]);else if(o in n)if(o in e&&!r||r&&"style"===o)if("style"===o)if("object"==typeof n[o]){let r=t[o]||{},s=n[o];for(let t in s)r[t]!==s[t]&&("-"===t[0]?e.style.setProperty(t,s[t]):e.style[t]=s[t])}else e.style.cssText=n[o];else e[o]=n[o];else r?e.setAttributeNS(null,o,n[o]):e.setAttribute(o,n[o]);else e.removeAttribute(o)}}function camelCase(e){return e.replace(/-+([\w])/g,(e,t)=>t.toUpperCase())}function unCamelCase(e){return e.replace(/([^\-])([A-Z]+)/,(e,t,n)=>t+"-"+n.toLowerCase())}function getProps(e){let t=Array.isArray(e),n=[],r={};for(let s in e){let o=unCamelCase(t?e[s]:s);t?n.push(o):(n.push(o),r[o]=e[s],r[camelCase(s)]=e[s])}return{keys:n,types:r}}class Element extends HTMLElement{constructor(){super();let e=createRender(this);this.props={},this.isMount=!1,this.countRender=0,this.preventRender=!1,this.proxy=getProps(this.constructor.props),this.rerender=(t=>{this.isMount&&(this.preventRender||(this.preventRender=!0,Promise.resolve().then(()=>{e(this.render()),this.preventRender=!1,this.countRender++?this.onUpdated():this.onMounted()})))}),this.proxy.keys.forEach(e=>{e=camelCase(e),Object.defineProperty(this,e,{set(t){this.setProps({[e]:t})},get(){return this.props[e]}})})}static get props(){return[]}render(){}onMounted(){}onUpdated(){}onUnmounted(){}setProps(e){let t,n={};for(let r in e){let s=this.props[r];if(e[r]!==s){let o=this.proxy.types[r],i=o?o(e[r],s):e[r];i!==s&&(n[r]=i,t=!0)}}t&&(this.props=Object.assign({},this.props,n),this.rerender())}setAttribute(e,t){this.proxy.keys.indexOf(e)>-1?this.setProps({[camelCase(e)]:t}):super.setAttribute(e,t)}static get observedAttributes(){return getProps(this.props).keys}connectedCallback(){this.isMount=!0,this.rerender()}disconnectedCallback(){this.isMount&&this.onUnmounted()}attributeChangedCallback(e,t,n){this.setProps({[e]:n})}}export{Element,h,createRender};
//# sourceMappingURL=atomico.m.js.map
